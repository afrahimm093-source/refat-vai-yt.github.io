import telebot
import requests

# ржЖржкржирж╛рж░ рждржерзНржпрж╕ржорзВрж╣
BOT_TOKEN = '8309553080:AAGicJOAFVVxfhJNY46ts-8IP3G4pqS_-gQ'
GEMINI_KEY = 'AIzaSyDNUHX3KqElLV5f1Hg18AiHbMM_AlAi-_E'
BINANCE_ID = '1173582246'

bot = telebot.TeleBot(BOT_TOKEN)

# ржПржЖржЗ-ржХрзЗ ржЖржкржирж╛рж░ ржмрж┐ржЬржирзЗрж╕ рж╕ржорзНржкрж░рзНржХрзЗ рж╢рзЗржЦрж╛ржирзЛрж░ ржЬржирзНржп ржкрзНрж░ржорзНржкржЯ
SYSTEM_PROMPT = f"""
рждрзБржорж┐ рж░рж┐ржлрж╛рждрзЗрж░ ржмрж┐ржЬржирзЗрж╕рзЗрж░ ржПржХржЬржи рж╕рзНржорж╛рж░рзНржЯ ржЕрзНржпрж╛рж╕рж┐рж╕рзНржЯрзНржпрж╛ржирзНржЯред рждрзЛржорж╛рж░ ржХрж╛ржЬ рж╣рж▓рзЛ ржЖржорж╛ржжрзЗрж░ рж╕рж╛рж░рзНржнрж┐рж╕ ржирж┐рзЯрзЗ ржХржерж╛ ржмрж▓рж╛ред
ржЖржорж╛ржжрзЗрж░ ржкрзНрж░ржзрж╛ржи рж╕рж╛рж░рзНржнрж┐рж╕ рж╣рж▓рзЛ ржкрзНрж░ржХрзНрж╕рж┐ рж╕рж╛рж░рзНржнрж╛рж░ (Proxy Server)ред
ржжрж╛ржо: 
рзз. рж▓рзЛржХрж╛рж▓ ржкрзНрж░ржХрзНрж╕рж┐ (Local Proxy): рзмрзжрзж ржЯрж╛ржХрж╛ред
рзи. ржнрж┐ржЖржЗржкрж┐ ржкрзНрж░ржХрзНрж╕рж┐ (VIP Proxy): рззрзирзжрзж ржЯрж╛ржХрж╛ред

ржкрзЗржорзЗржирзНржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржХрж╛рж╕рзНржЯржорж╛рж░ржХрзЗ ржЖржорж╛ржжрзЗрж░ ржмрж╛ржЗржирж╛ржирзНрж╕ ржЖржЗржбрж┐ (Binance ID): {BINANCE_ID} ржжрж┐рждрзЗ рж╣ржмрзЗред
рж╕ржм рж╕ржорзЯ рж░рж┐ржлрж╛рждрзЗрж░ ржкржХрзНрж╖ ржерзЗржХрзЗ ржЦрзБржм рж╕рзБржирзНржжрж░ ржПржмржВ ржкрзЗрж╢рж╛ржжрж╛рж░ржнрж╛ржмрзЗ ржХржерж╛ ржмрж▓ржмрзЗред
"""

def get_ai_reply(user_query):
    url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key={GEMINI_KEY}"
    # рж╕рж┐рж╕рзНржЯрзЗржо ржкрзНрж░ржорзНржкржЯ рж╕рж╣ ржорзЗрж╕рзЗржЬ ржкрж╛ржарж╛ржирзЛ рж╣ржЪрзНржЫрзЗ ржпрзЗржи ржПржЖржЗ ржЖржкржирж╛рж░ ржмрж┐ржЬржирзЗрж╕ рж╕ржорзНржкрж░рзНржХрзЗ ржЬрж╛ржирзЗ
    combined_query = SYSTEM_PROMPT + "\nUser asks: " + user_query
    data = {"contents": [{"parts": [{"text": combined_query}]}]}
    
    try:
        res = requests.post(url, json=data)
        return res.json()['candidates'][0]['content']['parts'][0]['text']
    except:
        return "ржжрзБржГржЦрж┐ржд, ржЖржорж┐ ржПржЗ ржорзБрж╣рзВрж░рзНрждрзЗ ржХрж┐ржЫрзБржЯрж╛ ржмрзНржпрж╕рзНрждред ржкрзНрж░ржХрзНрж╕рж┐ рж╕рж╛рж░рзНржнрж╛рж░ ржмрж╛ ржкрзЗржорзЗржирзНржЯ ржирж┐рзЯрзЗ ржЬрж╛ржирждрзЗ рж╕рж░рж╛рж╕рж░рж┐ ржорзЗрж╕рзЗржЬ ржжрж┐ржиред"

@bot.message_handler(commands=['start'])
def send_welcome(message):
    bot.reply_to(message, "рж╕рзНржмрж╛ржЧрждржо! ржЖржорж┐ рж░рж┐ржлрж╛рждрзЗрж░ ржПржЖржЗ ржЕрзНржпрж╛рж╕рж┐рж╕рзНржЯрзНржпрж╛ржирзНржЯред ржЖржорж╛ржжрзЗрж░ ржкрзНрж░ржХрзНрж╕рж┐ рж╕рж╛рж░рзНржнрж╛рж░ рж╕рж╛рж░рзНржнрж┐рж╕ ржПржмржВ ржкрзЗржорзЗржирзНржЯ рж╕ржорзНржкрж░рзНржХрзЗ ржЬрж╛ржирждрзЗ ржЖржорж╛ржХрзЗ ржкрзНрж░рж╢рзНржи ржХрж░рзБржиред")

@bot.message_handler(func=lambda message: True)
def handle_messages(message):
    user_msg = message.text.lower()
    
    # ржкрзЗржорзЗржирзНржЯ ржмрж╛ ржжрж╛ржо рж╕ржВржХрзНрж░рж╛ржирзНржд рж╕рж░рж╛рж╕рж░рж┐ ржЪрзЗржХ
    if any(word in user_msg for word in ["ржкрзЗржорзЗржирзНржЯ", "ржмрж╛ржЗржирж╛ржирзНрж╕", "ржЯрж╛ржХрж╛", "binance", "id"]):
        payment_text = f"ЁЯТ░ ржЖржорж╛ржжрзЗрж░ ржмрж╛ржЗржирж╛ржирзНрж╕ ржЖржЗржбрж┐: `{BINANCE_ID}`\nржЯрж╛ржХрж╛ ржкрж╛ржарж┐рзЯрзЗ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ ржжрж┐ржиред"
        bot.reply_to(message, payment_text, parse_mode='Markdown')
    elif any(word in user_msg for word in ["ржжрж╛ржо", "price", "ржкрзНрж░ржХрзНрж╕рж┐", "proxy"]):
        price_text = "ЁЯЪА **ржЖржорж╛ржжрзЗрж░ ржкрзНрж░ржХрзНрж╕рж┐ рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ ржжрж╛ржо:**\nтЬЕ рж▓рзЛржХрж╛рж▓ ржкрзНрж░ржХрзНрж╕рж┐: рзмрзжрзж ржЯрж╛ржХрж╛\nЁЯФе ржнрж┐ржЖржЗржкрж┐ ржкрзНрж░ржХрзНрж╕рж┐: рззрзирзжрзж ржЯрж╛ржХрж╛"
        bot.reply_to(message, price_text, parse_mode='Markdown')
    else:
        # ржмрж╛ржХрж┐ рж╕ржм рж╕рж╛ржзрж╛рж░ржг ржХржерж╛рж░ ржЙрждрзНрждрж░ ржПржЖржЗ ржжрж┐ржмрзЗ
        reply = get_ai_reply(message.text)
        bot.reply_to(message, reply)

print("ржмржЯ рж╕ржЪрж▓ рж╣рзЯрзЗржЫрзЗ...")
bot.infinity_polling()
